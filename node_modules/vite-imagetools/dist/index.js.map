{"version":3,"file":"index.js","sources":["../src/utils.ts","../src/index.ts"],"sourcesContent":["import { createHash } from 'node:crypto'\nimport path from 'node:path'\nimport { statSync } from 'node:fs'\nimport type { ImageConfig } from 'imagetools-core'\nimport type { Sharp } from 'sharp'\n\nexport const createBasePath = (base?: string) => {\n  return (base?.replace(/\\/$/, '') || '') + '/@imagetools/'\n}\n\nexport async function generateImageID(url: URL, config: ImageConfig, originalImage: Sharp) {\n  if (url.host) {\n    const baseURL = new URL(url.origin + url.pathname)\n    const buffer = await originalImage.toBuffer()\n    return hash([baseURL.href, JSON.stringify(config), buffer])\n  }\n\n  // baseURL isn't a valid URL, but just a string used for an identifier\n  // use a relative path in the local case so that it's consistent across machines\n  const baseURL = new URL(url.protocol + path.relative(process.cwd(), url.pathname))\n  const { mtime } = statSync(path.resolve(process.cwd(), decodeURIComponent(url.pathname)))\n  return hash([baseURL.href, JSON.stringify(config), mtime.getTime().toString()])\n}\n\nfunction hash(keyParts: Array<string | NodeJS.ArrayBufferView>) {\n  let hash = createHash('sha1')\n  for (const keyPart of keyParts) {\n    hash = hash.update(keyPart)\n  }\n  return hash.digest('hex')\n}\n","import { basename, extname } from 'node:path'\nimport type { Plugin, ResolvedConfig } from 'vite'\nimport {\n  applyTransforms,\n  builtins,\n  builtinOutputFormats,\n  extractEntries,\n  generateTransforms,\n  getMetadata,\n  parseURL,\n  urlFormat,\n  resolveConfigs,\n  type Logger,\n  type OutputFormat,\n  type ProcessedImageMetadata\n} from 'imagetools-core'\nimport { createFilter, dataToEsm } from '@rollup/pluginutils'\nimport sharp, { type Metadata, type Sharp } from 'sharp'\nimport { createBasePath, generateImageID } from './utils.js'\nimport type { VitePluginOptions } from './types.js'\n\nexport type {\n  Include,\n  Exclude,\n  DefaultDirectives,\n  ExtendTransforms,\n  ExtendOutputFormats,\n  ResolveConfigs,\n  VitePluginOptions\n} from './types.js'\n\nconst defaultOptions: VitePluginOptions = {\n  include: /^[^?]+\\.(avif|gif|heif|jpeg|jpg|png|tiff|webp)(\\?.*)?$/,\n  exclude: 'public/**/*',\n  removeMetadata: true\n}\n\nexport * from 'imagetools-core'\n\nexport function imagetools(userOptions: Partial<VitePluginOptions> = {}): Plugin {\n  const pluginOptions: VitePluginOptions = { ...defaultOptions, ...userOptions }\n\n  const filter = createFilter(pluginOptions.include, pluginOptions.exclude)\n\n  const transformFactories = pluginOptions.extendTransforms ? pluginOptions.extendTransforms(builtins) : builtins\n\n  const outputFormats: Record<string, OutputFormat> = pluginOptions.extendOutputFormats\n    ? pluginOptions.extendOutputFormats(builtinOutputFormats)\n    : builtinOutputFormats\n\n  let viteConfig: ResolvedConfig\n  let basePath: string\n\n  const generatedImages = new Map<string, Sharp>()\n\n  return {\n    name: 'imagetools',\n    enforce: 'pre',\n    configResolved(cfg) {\n      viteConfig = cfg\n      basePath = createBasePath(viteConfig.base)\n    },\n    async load(id) {\n      if (!filter(id)) return null\n\n      const srcURL = parseURL(id)\n\n      // lazy loaders so that we can load the metadata in defaultDirectives if needed\n      // but if there are no directives then we can just skip loading\n      let lazyImg: Sharp\n      const lazyLoadImage = () => {\n        if (lazyImg) return lazyImg\n        return (lazyImg = sharp(decodeURIComponent(srcURL.pathname)))\n      }\n\n      let lazyMetadata: Metadata\n      const lazyLoadMetadata = async () => {\n        if (lazyMetadata) return lazyMetadata\n        return (lazyMetadata = await lazyLoadImage().metadata())\n      }\n\n      const defaultDirectives =\n        typeof pluginOptions.defaultDirectives === 'function'\n          ? await pluginOptions.defaultDirectives(srcURL, lazyLoadMetadata)\n          : pluginOptions.defaultDirectives || new URLSearchParams()\n      const directives = new URLSearchParams({\n        ...Object.fromEntries(defaultDirectives),\n        ...Object.fromEntries(srcURL.searchParams)\n      })\n\n      if (!directives.toString()) return null\n\n      const img = lazyLoadImage()\n      const widthParam = directives.get('w')\n      const heightParam = directives.get('h')\n      if (directives.get('allowUpscale') !== 'true' && (widthParam || heightParam)) {\n        const metadata = await lazyLoadMetadata()\n        const clamp = (s: string, intrinsic: number) =>\n          [...new Set(s.split(';').map((d): string => (parseInt(d) <= intrinsic ? d : intrinsic.toString())))].join(';')\n\n        if (widthParam) {\n          const intrinsicWidth = metadata.width || 0\n          directives.set('w', clamp(widthParam, intrinsicWidth))\n        }\n\n        if (heightParam) {\n          const intrinsicHeight = metadata.height || 0\n          directives.set('h', clamp(heightParam, intrinsicHeight))\n        }\n      }\n\n      const parameters = extractEntries(directives)\n      const imageConfigs =\n        pluginOptions.resolveConfigs?.(parameters, outputFormats) ?? resolveConfigs(parameters, outputFormats)\n\n      const outputMetadatas: Array<ProcessedImageMetadata> = []\n\n      const logger: Logger = {\n        info: (msg) => viteConfig.logger.info(msg),\n        warn: (msg) => this.warn(msg),\n        error: (msg) => this.error(msg)\n      }\n\n      for (const config of imageConfigs) {\n        const { transforms } = generateTransforms(config, transformFactories, srcURL.searchParams, logger)\n        const { image, metadata } = await applyTransforms(transforms, img.clone(), pluginOptions.removeMetadata)\n\n        if (viteConfig.command === 'serve') {\n          const id = await generateImageID(srcURL, config, img)\n          generatedImages.set(id, image)\n          metadata.src = basePath + id\n        } else {\n          const fileHandle = this.emitFile({\n            name: basename(srcURL.pathname, extname(srcURL.pathname)) + `.${metadata.format}`,\n            source: await image.toBuffer(),\n            type: 'asset'\n          })\n\n          metadata.src = `__VITE_ASSET__${fileHandle}__`\n        }\n\n        metadata.image = image\n\n        outputMetadatas.push(metadata as ProcessedImageMetadata)\n      }\n\n      let outputFormat = urlFormat()\n      const asParam = directives.get('as')?.split(':')\n      const as = asParam ? asParam[0] : undefined\n      for (const [key, format] of Object.entries(outputFormats)) {\n        if (as === key) {\n          outputFormat = format(asParam && asParam[1] ? asParam[1].split(';') : undefined)\n          break\n        }\n      }\n\n      return dataToEsm(await outputFormat(outputMetadatas), {\n        namedExports: pluginOptions.namedExports ?? viteConfig.json?.namedExports ?? true,\n        compact: !!viteConfig.build.minify ?? false,\n        preferConst: true\n      })\n    },\n\n    configureServer(server) {\n      server.middlewares.use((req, res, next) => {\n        if (req.url?.startsWith(basePath)) {\n          const [, id] = req.url.split(basePath)\n\n          const image = generatedImages.get(id)\n\n          if (!image)\n            throw new Error(`vite-imagetools cannot find image with id \"${id}\" this is likely an internal error`)\n\n          if (pluginOptions.removeMetadata === false) {\n            image.withMetadata()\n          }\n\n          res.setHeader('Content-Type', `image/${getMetadata(image, 'format')}`)\n          res.setHeader('Cache-Control', 'max-age=360000')\n          return image.clone().pipe(res)\n        }\n\n        next()\n      })\n    }\n  }\n}\n"],"names":[],"mappings":"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"}